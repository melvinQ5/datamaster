-- todo 聚合表输出需要先写入临时表，再查询导出（因为一次要多周） ； 链接明细可以直接查SQL导出（因为只有一周）

insert into manual_table_duplicate (wttime,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20,c21,c22,c23,c24,c25,c26,c27,c28,c29,c30,c31,c32,c33,c34,c35,c36)
with
prod as (
select wp.sku ,wp.spu ,wp.BoxSku
  ,ifnull(ele_name_priority,'无元素标签') 优先级元素
  ,ifnull(istheme,'非主题品') 主题
  ,ifnull(ispotenial,'非高潜品') 高潜
  ,left(DevelopLastAuditTime,7) 终审年月
    ,wp.cat1 一级类目
  ,case when wp.DevelopLastAuditTime >=  date_add( DATE_ADD('${StartDay}',interval -day( '${StartDay}'  )+1 day) ,interval -2 month)
    and wp.DevelopLastAuditTime <'${NextStartDay}' then '新品' else '老品' end as 新老品 -- 新老品快照
from wt_products wp
left join dep_kbh_product_test vke on wp.SKU = vke.sku
where wp.ProjectTeam='快百货' and wp.IsDeleted=0
  -- and wp.ProductStatus !=2
)

,mysql_store_team as ( -- 剔除定制运营组,增加dep2区域维度
select case when NodePathName regexp  '成都' then '成都' else '泉州' end as dep2,* from import_data.mysql_store where Department = '快百货' and NodePathName != '定制运营组'
)

,od_pay as (   -- 销售额不含退款数据，利润额不含退款不含广告
select wo.shopcode ,wo.SellerSku ,ifnull(wo.Product_Sku,0) as sku
    ,round( sum( case when TransactionType = '退款' then 0 else TotalGross/ExchangeUSD end ),2 ) sales_undeduct_refunds
    ,round( sum( case
	    	when TransactionType = '退款' then 0
	    	when TransactionType='其他' and left(wo.SellerSku,10)='ProductAds' then 0
	    	else TotalProfit/ExchangeUSD end ),2 ) profit_undeduct_refunds
    ,round( sum(salecount ),2) salecount
    ,count(distinct PlatOrderNumber) orders_cnt
    ,count(distinct Product_SPU) od_spu_cnt
	,round( sum(FeeGross/ExchangeUSD) ,4) `运费收入`
	,round( sum(TradeCommissions/ExchangeUSD) ,4) `交易成本`
	,round( sum(PurchaseCosts/ExchangeUSD) ,4) `采购成本`
    ,abs( round( sum(  (LocalFreight + OverseasDeliveryFee + HeadFreight + FBAFee ) /ExchangeUSD ) ,4) ) 物流成本
    ,sum( case when FeeGross = 0 and OrderStatus <> '作废' and TransactionType = '付款' then TotalGross/ExchangeUSD end ) ori_gross
    ,sum( case when FeeGross = 0 and OrderStatus <> '作废' and TransactionType = '付款' then TotalProfit/ExchangeUSD end ) ori_profit
from import_data.wt_orderdetails wo
join mysql_store_team  ms on wo.shopcode=ms.Code
left join view_kbh_add_refunddate_to_wtord_tmp vr on wo.OrderNumber = vr.OrderNumber
left join dep_kbh_product_test d on wo.BoxSku = d.boxsku
left join view_kbh_lst_pub_tag vl on wo.shopcode =vl.shopcode and wo.sellersku = vl.sellersku and wo.BoxSku=vl.boxsku  -- vl整个视图只有37条boxsku为空，目前比较靠谱的匹配方案
left join wt_products wp on wo.Product_Sku =wp.sku and wp.IsDeleted=0 and wp.ProjectTeam='快百货'
where wo.IsDeleted = 0 and PayTime >='${StartDay}' and PayTime<'${NextStartDay}'
group by wo.shopcode ,wo.SellerSku ,wo.Product_Sku
)

,od_refund as ( -- 销售额对应退款额，利润额对应退款额
select shopcode ,SellerSku ,ifnull(wo.Product_Sku,0) as sku
    ,abs(round( sum( TotalGross/ExchangeUSD ),2 )) sales_refund
    ,abs(round( sum( TotalProfit/ExchangeUSD ),2 )) profit_refund
from import_data.wt_orderdetails wo
join ( select case when NodePathName regexp  '成都' then '快百货一部' else '快百货二部' end as dep2,* from import_data.mysql_store )  ms on wo.shopcode=ms.Code  and ms.Department='快百货'
join view_kbh_add_refunddate_to_wtord_tmp vr on wo.OrderNumber = vr.OrderNumber
where wo.IsDeleted = 0 and max_refunddate >='${StartDay}' and max_refunddate<'${NextStartDay}'  and TransactionType = '退款'
group by shopcode ,SellerSku ,sku
)

,od_stat_pre as ( -- 扣退款
select  shopcode  ,sellersku ,sku
    ,sum( sales_undeduct_refunds ) as sales
    ,sum( profit_undeduct_refunds ) as profit
    ,sum( sales_refund ) as sales_refund
from (
    select  shopcode  ,sellersku  ,sku , sales_undeduct_refunds  ,profit_undeduct_refunds ,0 as  sales_refund from od_pay a
    union
    select  shopcode  ,sellersku ,sku , -1*sales_refund  ,-1*profit_refund ,sales_refund  from od_refund a
    ) t
group by shopcode  ,sellersku ,sku
)

,od_stat as(
select a.shopcode ,a.SellerSku ,a.sku ,sales ,profit ,sales_refund
,salecount
, orders_cnt
,od_spu_cnt
, `运费收入`
,`交易成本`
,`采购成本`
,物流成本
,round(ori_gross,2) ori_gross
,round(ori_profit,2) ori_profit
from od_stat_pre a left join od_pay b on a.SellerSku =b.SellerSku and a.shopcode =b.shopcode and a.sku =b.sku
)

-- ----------计算广告表现

,t_ad as ( --
select  waad.shopcode ,waad.SellerSku ,waad.sku
     ,AdSales as TotalSale7Day , AdSaleUnits as TotalSale7DayUnit
    , waad.AdClicks as Clicks  , waad.AdExposure as Exposure ,waad.AdSpend as Spend
    , AdROAS as ROAS ,AdAcost as ACOS
from wt_adserving_amazon_daily waad -- 保留所有打标签链接，并对有曝光数据的链接进行行拆分
join  mysql_store ms on ms.code = waad.ShopCode and ms.Department = '快百货' and  GenerateDate >=  date_add('${StartDay}',interval -1 day) and GenerateDate <  date_add('${NextStartDay}',interval -1 day)
left join dep_kbh_lst_sku_maps_test wl on waad.ShopCode = wl.ShopCode and  waad.SellerSKU = wl.SellerSKU -- todo 广告表sku出问题时 临时重新生成数据使用
)

,add_ad_sku as ( -- todo 临时补充sku, 需解决广告日表中缺失SKU问题》进而需要解决erp_listing表中 ProductId 无效的问题
select  wl.SellerSKU ,wl.ShopCode ,max(wl.sku) sku
from (select shopcode ,sellersku from t_ad where sku is null group by shopcode, sellersku) t1
join erp_amazon_amazon_listing wl on wl.ShopCode = t1.ShopCode and wl.SellerSKU = t1.SellerSku
group by wl.SellerSKU ,wl.ShopCode
)

, t_ad_stat as (
select  t1.shopcode  ,t1.SellerSku  ,coalesce(t1.sku,t2.sku) sku
-- 曝光量
, round(sum(Exposure)) as ad_sku_Exposure
-- 广告花费
, round(sum(Spend),2) as ad_Spend
-- 广告销售额
, round(sum(TotalSale7Day),2) as ad_TotalSale7Day
-- 广告销量
, round(sum(TotalSale7DayUnit),2) as ad_sku_TotalSale7DayUnit
-- 点击量
, round(sum(Clicks)) as ad_sku_Clicks
from t_ad  t1
left join add_ad_sku t2  on t2.ShopCode = t1.ShopCode and t2.SellerSKU = t1.SellerSku
group by  t1.shopcode  ,t1.SellerSku  ,coalesce(t1.sku,t2.sku)
)

,t_online_lst as (
select ShopCode ,SellerSKU ,sku
from wt_listing wl join mysql_store ms on wl.ShopCode=ms.Code and ms.Department='快百货' and ListingStatus = 1 and ShopStatus='正常' group by ShopCode, SellerSKU, sku
)

,ware_stat as(
select   round( sum( `当前在仓产品金额`)/10000,4) `总在仓产品金额_万元` -- 万元
from  dep_kbh_product_test wp
join  (
	SELECT boxsku ,sum(ifnull(TotalPrice,0)) `当前在仓产品金额`
	FROM ( -- local_warehouse 本地仓表
		select TotalPrice, TotalInventory ,wi.boxsku
		FROM import_data.daily_WarehouseInventory wi
		join ( select BoxSku ,projectteam as department from wt_products where  IsDeleted=0 and ProjectTeam='快百货' ) tmp on wi.BoxSku = tmp.BoxSku
		where WarehouseName = '东莞仓' and TotalInventory > 0
		  and CreatedTime = date_add('${NextStartDay}',-1) and department = '快百货'
		)  tmp
	group by boxsku
) ware on wp.boxsku = ware.boxsku
)

,prod_stat as ( -- 不看链接分层和出单团队
select  count(distinct a.spu) 总未停产SPU数
from dep_kbh_product_test a
left join wt_products wp on a.sku = wp.sku and IsDeleted=0 and ProjectTeam='快百货'
where a.ProductStatus !=2
)

,online_lst as (
select shopcode , sellersku from erp_amazon_amazon_listing eaal join mysql_store_team ms on eaal.ShopCode = ms.code
    and ShopStatus='正常' and ListingStatus=1 group by shopcode ,sellersku
)

,t0 as ( -- todo 广告表中有该链接，但链接表中无该链接，导致链接关联SKU未成功  ShopCode='ZI-ES'  and SellerSKU = 'P230920F8VY02TZIUK-02'
select t.* ,prod.spu
     ,week_num_in_year ,month, '${StartDay}' firstday
     ,终审年月 ,新老品 ,主题, 高潜 ,一级类目 ,优先级元素
     ,case when SellerSku regexp 'Event' then '是' else '否' end 是否结算项记录
from ( select shopcode ,SellerSku , sku from od_stat
    union select shopcode ,SellerSku , sku from t_online_lst
    union select shopcode ,SellerSku , sku from t_ad_stat  -- where length(sku) >0 -- 广告表里面存在sku为空的记录
    ) t
join ( select week_num_in_year,month from dim_date where full_date = '${StartDay}' ) dd
left join prod on t.sku =prod.sku
where left(t.sku,7) in ('1023253',
 '5097107',
 '1041553',
 '5012989',
 '5014567',
 '5018821',
 '5191100',
 '5031194',
 '5003760',
 '5009390',
 '1022007',
 '5002526',
 '1048469',
 '1035200',
 '5041424',
 '5264080',
 '1022987',
 '5004121',
 '5270829',
 '5315754',
 '1034293',
 '1038654',
 '5355727',
 '5014935',
 '5004627',
 '1037891',
 '5035444',
 '5190742',
 '5003519',
 '5040848',
 '1038338',
 '1148620',
 '5032216',
 '5212188',
 '5349164',
 '1059861',
 '1060747',
 '5020651',
 '1035972',
 '5252787',
 '5202790',
 '5071724',
 '5000953',
 '1042388',
 '5011722',
 '1148504',
 '5068436',
 '5055072',
 '1048896',
 '5004114',
 '1057884',
 '1044421',
 '5090385',
 '5020072',
 '5035490',
 '1047638',
 '1047209',
 '5087696',
 '5190008',
 '5215008',
 '5004736',
 '1038949',
 '5184838',
 '5040196',
 '5317150',
 '1062329',
 '1027744',
 '5078652',
 '5190674',
 '5000842',
 '5042593',
 '5012056',
 '1048323',
 '5355689',
 '5064717',
 '1041753',
 '5003491',
 '5020595',
 '5067256',
 '1040369',
 '5012291',
 '5086946',
 '5282383',
 '5191313',
 '5009810',
 '1031846',
 '1048994',
 '5141880',
 '5124519',
 '5190564',
 '5188863',
 '1042631',
 '5041625',
 '5077220',
 '5078550',
 '5264740',
 '5090165',
 '1005010',
 '5189916',
 '1031734',
 '1027061',
 '5083760',
 '1042121',
 '5213338',
 '1033734',
 '5189709',
 '5317989',
 '1041744',
 '1031489',
 '5095034',
 '5112764',
 '1043821',
 '5043203',
 '1004253',
 '1037997',
 '5103086',
 '5024351',
 '1033316',
 '1035997',
 '1037788',
 '1038802',
 '5259659',
 '1064900',
 '5272548',
 '5014065',
 '5007081',
 '1031877',
 '5068517',
 '5013778',
 '5040440',
 '5039286',
 '1017597',
 '5201955',
 '1043229',
 '1034481',
 '1036395',
 '1042231',
 '5051087',
 '5279186',
 '1061334',
 '5326279',
 '1036265',
 '5005309',
 '5014582',
 '5328589',
 '1054924',
 '1038055',
 '1052552',
 '1045581',
 '1040359',
 '1129093',
 '1037412',
 '5346851',
 '1045462',
 '1011684',
 '5319746',
 '1045470',
 '5102033',
 '5214669',
 '5042271',
 '1043152',
 '5093970',
 '5030368',
 '5322289',
 '1028222',
 '1034195',
 '1013651',
 '1057615',
 '1060742',
 '1039981',
 '5215053',
 '5000516',
 '5111327',
 '5125407',
 '5017249',
 '5243191',
 '5014096',
 '5071733',
 '5074439',
 '5039253',
 '1128299',
 '5349674',
 '1056968',
 '1012035',
 '5038436',
 '5094595',
 '5244970',
 '5248424',
 '1041556',
 '5007465',
 '1063523',
 '5044390',
 '1011676',
 '1043167',
 '5022081',
 '1001605',
 '5322535',
 '5304640',
 '5341775',
 '5338744',
 '5085171',
 '5096681',
 '5109097',
 '5118345',
 '1011660',
 '5093131',
 '1036837',
 '5294402',
 '5010879',
 '1065204',
 '5002966',
 '5218798',
 '5321445',
 '1006467',
 '5254879',
 '5040915',
 '5049124',
 '5042554',
 '5088964',
 '5039380',
 '5000897',
 '5251405',
 '5007681',
 '1041383',
 '5217826',
 '5245364',
 '5084721',
 '5263717',
 '5261549',
 '1025251',
 '5216748',
 '1008915',
 '5270221',
 '1035188',
 '1016006',
 '5006964',
 '1001758',
 '5076328',
 '5039667',
 '1021490',
 '1042845',
 '5014795',
 '1018100',
 '1029888',
 '5076164',
 '5357712',
 '5020109',
 '5065925',
 '5348207',
 '5025203',
 '5171954',
 '5004413',
 '1040234',
 '5020538',
 '5015212',
 '1033704',
 '5036727',
 '1021683',
 '5190903',
 '1048304',
 '5201950',
 '5191010',
 '5257819',
 '1035034',
 '5019498',
 '5014047',
 '1037303',
 '5065936',
 '5223380',
 '1036935',
 '5271572',
 '5100313',
 '5021188',
 '1031432',
 '5004023',
 '1041464',
 '5098629',
 '5015972',
 '5270258',
 '5190924',
 '5050847',
 '1031723',
 '5263236',
 '5025818',
 '5213429',
 '1042201',
 '5328973',
 '5013633',
 '5026898',
 '5032569',
 '1058355',
 '5070508',
 '5277418',
 '5005166',
 '5040593',
 '1041740',
 '5064860',
 '5070948',
 '5191301',
 '5355779',
 '1014232',
 '5290121',
 '5279949',
 '1148727',
 '5009770',
 '5064876',
 '1040204',
 '5011059',
 '5010128',
 '5053572',
 '5350629',
 '1063313',
 '5125379',
 '5070824',
 '5191402',
 '5084121',
 '1055909',
 '5042597',
 '5078914',
 '5010377',
 '5002659',
 '5017120',
 '5074638',
 '1042114',
 '1057854',
 '1059206',
 '5009833',
 '5014374',
 '5347572',
 '5221408',
 '1052553',
 '1042600',
 '1028307',
 '1048312',
 '1033995',
 '5338739',
 '5145525',
 '5035380',
 '1043619',
 '1015290',
 '1049640',
 '5148170',
 '1030252',
 '5078921',
 '1020459',
 '5135328',
 '1033987',
 '5019278',
 '5026462',
 '5081129',
 '5345384',
 '5087446',
 '5077003',
 '5076083',
 '5295989',
 '1047663',
 '5064974',
 '5021412',
 '1060826',
 '5044665',
 '1042400',
 '1048963',
 '5219154',
 '5101457',
 '1043265',
 '1061203',
 '1033500',
 '1007689',
 '5038259',
 '5084498',
 '5044541',
 '5094370',
 '1148624',
 '5023401',
 '5028899',
 '5045013',
 '1046668',
 '1023147',
 '1035600',
 '5005451',
 '1043858',
 '1021262',
 '5241109',
 '1004772',
 '5140546',
 '5122677',
 '1045644',
 '5191526',
 '1002807',
 '1043242',
 '1041905',
 '5026656',
 '5072553',
 '5114868',
 '5040989',
 '1038650',
 '1058644',
 '5350254',
 '5004137',
 '1017319',
 '5112318',
 '5064828',
 '5015314',
 '5288921',
 '5038301',
 '5040253',
 '5007591',
 '1042863',
 '5004950',
 '5032887',
 '1040715',
 '1002685',
 '1007517',
 '1057941',
 '1032347',
 '5009157',
 '1041665',
 '5071005',
 '5012257',
 '1054041',
 '5050892',
 '5219094',
 '5006943',
 '5003239',
 '5010674',
 '1057885',
 '5106631',
 '1047674',
 '5022272',
 '5030627',
 '5321463',
 '5053750',
 '5028067',
 '1004119',
 '5269627',
 '1064807',
 '1027167',
 '5261548',
 '5355331',
 '5006769',
 '1058784',
 '5269511',
 '5256262',
 '5246123',
 '5090350',
 '5070858',
 '1045474',
 '5030788',
 '5005923',
 '5098978',
 '5010529',
 '5105786',
 '1032878',
 '5084102',
 '1044378',
 '1033991',
 '5037143',
 '5260596',
 '1060240',
 '1040102',
 '5091316',
 '1002254',
 '5214717',
 '5239981',
 '1056848',
 '1091255',
 '1005420',
 '5190577',
 '5003274',
 '1042622',
 '1054165',
 '5046762',
 '5083968',
 '5078543',
 '1034018',
 '1041595',
 '5354185',
 '5171961',
 '5017188',
 '1033312',
 '5005545',
 '5019702',
 '1055668',
 '5141971',
 '5081119',
 '5016443',
 '5190393',
 '1059458',
 '5090554',
 '5028902',
 '5004706',
 '5270705',
 '5051483',
 '1031032',
 '5282395',
 '5018794',
 '5268566',
 '5099589',
 '5221177',
 '1006914',
 '1148489',
 '1019095',
 '5268484',
 '5243255',
 '5266833',
 '5307527',
 '1038109',
 '5002268',
 '5247270',
 '1041821',
 '5221150',
 '1047365',
 '1049564',
 '5325643',
 '1009620',
 '5087353',
 '1033994',
 '5074584',
 '5020762',
 '5014949',
 '5001438',
 '1002904',
 '5026295',
 '1045128',
 '5190252',
 '5070539',
 '5128328',
 '1037400',
 '1048530',
 '5100220',
 '1006817',
 '1067521',
 '5004448',
 '5035453',
 '5020563',
 '5076091',
 '1003635',
 '5052513',
 '1064889',
 '5039240',
 '5012491',
 '5044163',
 '1000297',
 '5099725',
 '5013021',
 '5051471',
 '5000944',
 '1034194',
 '1108848',
 '5201707',
 '5260241',
 '5064884',
 '5011402',
 '1015878',
 '5317812',
 '5256267',
 '5190746',
 '1033214',
 '5191214',
 '5130588',
 '1064465',
 '5065754',
 '1009415',
 '1059148',
 '1020433',
 '5005218',
 '5049120',
 '5077036',
 '5005477',
 '1003358',
 '1032691',
 '5102130',
 '5070912',
 '1031884',
 '1007952',
 '5006759',
 '5341446',
 '5266790',
 '1000194',
 '1015936',
 '5039848',
 '5140849',
 '5268450',
 '5321440',
 '5078755',
 '5214688',
 '1049290',
 '1089603',
 '5035750',
 '5097532',
 '5023875',
 '5005079',
 '5216831',
 '5246475',
 '5295991',
 '5154836',
 '5244282',
 '1005342',
 '5045163',
 '5310363',
 '1033581',
 '5020315',
 '1043724',
 '5002291',
 '5270346',
 '5252788',
 '1016989',
 '5040268',
 '1012926',
 '1065357',
 '5261662',
 '5011482',
 '5140876',
 '1034600',
 '1044384',
 '5190896',
 '1010553',
 '5005200',
 '5222129',
 '5247606',
 '1045316',
 '5256994',
 '5242740',
 '5083317',
 '5105524',
 '5278250',
 '5023708',
 '1003763',
 '5032109',
 '1018040',
 '5039402',
 '5221131',
 '5220463',
 '5013781',
 '5117080',
 '5003522',
 '5012798',
 '1009392',
 '1038311',
 '5094078',
 '5042334',
 '1039309',
 '1059848',
 '5243507',
 '5296937',
 '5244969',
 '1062199',
 '5338758',
 '1019207',
 '1013325',
 '1037791',
 '1033038',
 '5022133',
 '5197097',
 '1055910',
 '5243325',
 '5016107',
 '5355899',
 '5025342',
 '1044456',
 '1046350',
 '5354198',
 '1035791',
 '1056860',
 '5009976',
 '5039105',
 '5197708',
 '1060036',
 '5005001',
 '5270796',
 '1035905',
 '5024534',
 '1065093',
 '1065541',
 '5012123',
 '5350136',
 '1044580',
 '5217865',
 '5033992',
 '5081599',
 '1032259',
 '1019488',
 '5095092',
 '1020777',
 '5256232',
 '5093146',
 '5272576',
 '1063008',
 '1044376',
 '1020193',
 '5192700',
 '5019497',
 '1047468',
 '1011891',
 '5021619',
 '1064026',
 '5041062',
 '5277431',
 '1035654',
 '5220491',
 '5122204',
 '1048408',
 '5012614',
 '5270482',
 '5071065',
 '5210484',
 '5099696',
 '5329124',
 '5022532',
 '5190983',
 '5247668',
 '5270275',
 '5188926',
 '5099356',
 '5223414',
 '1028272',
 '1007318',
 '5040348',
 '5114887',
 '1008952',
 '5117065',
 '5042221',
 '1040344',
 '5345730',
 '1035651',
 '1002337',
 '5090727',
 '1048848',
 '5032557',
 '5305765',
 '1061266',
 '5105721',
 '5273014',
 '1020823',
 '5034792',
 '1034862',
 '5317994',
 '1061409',
 '1006549',
 '1047606',
 '5282389',
 '5075691',
 '5055001',
 '5041580',
 '1012821',
 '5190415',
 '5052728',
 '1041947',
 '1005542',
 '1000733',
 '5022947',
 '1035019',
 '1045237',
 '1002103',
 '5184858',
 '5093755',
 '5257008',
 '5263262',
 '5357848',
 '5249010',
 '1055518',
 '5052440',
 '5345379',
 '1040676',
 '5005478',
 '1011710',
 '5024301',
 '5009404',
 '5017934',
 '5250733',
 '5023786',
 '1038314',
 '5005502',
 '5268965',
 '5324583',
 '5266012',
 '5284377',
 '5075658',
 '1047385',
 '5271475',
 '5122156',
 '5355730',
 '1047560',
 '1023257',
 '1043498',
 '5052470',
 '1042859',
 '5096631',
 '5012020',
 '5264737',
 '5039323',
 '5031954',
 '1002502',
 '1064891',
 '1011856',
 '1039163',
 '5030464',
 '1047006',
 '5094369',
 '5002290',
 '1004885',
 '1043725',
 '1035195',
 '1041030',
 '5064760',
 '1030625',
 '5023493',
 '5008167',
 '5025241',
 '5049043',
 '5011253',
 '5038396',
 '1062819',
 '5023167',
 '1035043',
 '5099660',
 '1059849',
 '5012668',
 '1032778',
 '1022989',
 '1043866',
 '5348653',
 '5040549',
 '5008152',
 '5113728',
 '5021243',
 '1061347',
 '5355319',
 '5106446',
 '1015300',
 '1033817',
 '5042003',
 '1038417',
 '1011507',
 '5071628',
 '1036703',
 '5040127',
 '1029984',
 '1061494',
 '1057009',
 '5288237',
 '5047191',
 '1034679',
 '1063487',
 '1049335',
 '1029710',
 '5322565',
 '5084582',
 '5226387',
 '5024975',
 '1032410',
 '5354224',
 '5173195',
 '5189985',
 '1055439',
 '5191561',
 '1037339',
 '1010357',
 '5292978',
 '1036030',
 '5013804',
 '5028407',
 '1016057',
 '1034928',
 '5006566',
 '5158352',
 '5087358',
 '1050706',
 '5093653',
 '1023615',
 '1036841',
 '5021806',
 '1049037',
 '1129099',
 '1032712',
 '1001545',
 '5253050',
 '5093925',
 '1048146',
 '5018736',
 '5259906',
 '5064937',
 '5191256',
 '5094875',
 '5007307',
 '1063662',
 '5106794',
 '1031911',
 '5076941',
 '1000001',
 '5262203',
 '5190872',
 '5223407',
 '5001986',
 '1033989',
 '1034416',
 '5354207',
 '1003901',
 '5123948',
 '1055921',
 '1054149',
 '5038750',
 '1041809',
 '5007031',
 '5074501',
 '5243928',
 '5025361',
 '5016124',
 '1047379',
 '5084766',
 '5010880',
 '5027044',
 '5105918',
 '5189720',
 '5281308',
 '1044355',
 '1059181',
 '5314906',
 '1039195',
 '1037786',
 '5315007',
 '5014079',
 '5190414',
 '5268928',
 '5342382',
 '5002921',
 '1057915',
 '1036919',
 '5011044',
 '5231239',
 '5020955',
 '5103003',
 '5133919',
 '5263180',
 '5016890',
 '5000396',
 '5322560',
 '1032415',
 '1010591',
 '1039077',
 '5103621',
 '1041980',
 '1038030',
 '1047846',
 '1032112',
 '1016932',
 '5253739',
 '1032606',
 '5355848',
 '1042869',
 '5095076',
 '5009845',
 '5283774',
 '1010709',
 '1035370',
 '5005133',
 '5043329',
 '1014409',
 '1007750',
 '1037219',
 '5132740',
 '1039492',
 '5001966',
 '5191119',
 '5191181',
 '5189515',
 '5115167',
 '5041671',
 '1057817',
 '1039709',
 '5261666',
 '5017171',
 '1051042',
 '5309517',
 '5189296',
 '1001115',
 '5084710',
 '5100637',
 '5037361',
 '5127872',
 '5249792',
 '5012252',
 '5340769',
 '5025020',
 '1034949',
 '5014563',
 '5339200',
 '5026645',
 '1038927',
 '5268954',
 '5039425',
 '1007075',
 '5110088',
 '5342374',
 '5038915',
 '1043412',
 '1007773',
 '1037341',
 '5220773',
 '1017003',
 '5030595',
 '1016988',
 '5049195',
 '5229034',
 '5087724',
 '1040859',
 '1058986',
 '5242060',
 '1064890',
 '5189525',
 '5191463',
 '5100817',
 '1061360',
 '1040141',
 '5093898',
 '5004443',
 '5104042',
 '5020030',
 '5007226',
 '5038275',
 '1057751',
 '1038027',
 '1002976',
 '1044275',
 '5151504',
 '5004740',
 '5191351',
 '5028378',
 '5009022',
 '1059644',
 '1036942',
 '5077155',
 '5356269',
 '1042544',
 '5261645',
 '5018299',
 '5117093',
 '1038844',
 '5219178',
 '5042420',
 '1051344',
 '5190527',
 '1049288',
 '1037744',
 '5030442',
 '5190897',
 '1048208',
 '5032383',
 '5283153',
 '5012122',
 '1004995',
 '5087634',
 '5074530',
 '1062847',
 '5311388',
 '5256501',
 '5004677',
 '1031657',
 '5026688',
 '5099509',
 '5087589',
 '5260602',
 '1148490',
 '5040135',
 '1059239',
 '1031920',
 '5241013',
 '5076198',
 '1044445',
 '1012836',
 '1041217',
 '1063270',
 '5353628',
 '5285165',
 '5219225',
 '5013609',
 '5094870',
 '5077057',
 '5274787',
 '1022529',
 '5152577',
 '5008374',
 '5021229',
 '5219112',
 '5029155',
 '1042229',
 '1035028',
 '5122507',
 '5294639',
 '1046959',
 '1047131',
 '1000702',
 '5006484',
 '1040065',
 '5245002',
 '5070605',
 '1038136',
 '1034569',
 '5022894',
 '1034412',
 '1048640',
 '5074504',
 '1004939',
 '5085114',
 '5014588',
 '5024468',
 '5356289',
 '5003982',
 '5094980',
 '5252479',
 '1032798',
 '5025295',
 '1048494',
 '5110122',
 '1060994',
 '5012237',
 '5189733',
 '1002001',
 '1033911',
 '1011895',
 '5111755',
 '1008598',
 '1037650',
 '5201948',
 '5270274',
 '1044208',
 '1064841',
 '1040539',
 '1003429',
 '5017219',
 '1003163',
 '1037391',
 '1046834',
 '5093150',
 '5048981',
 '1042293',
 '1034423',
 '1009067',
 '1059441',
 '5096840',
 '5044699',
 '5020946',
 '1048915',
 '5109950',
 '5190658',
 '5231238',
 '1017220',
 '1055670',
 '1035787',
 '5215024',
 '5305776',
 '5084464',
 '5223421',
 '5114121',
 '5011751',
 '1042363',
 '5022125',
 '5310353',
 '1002890',
 '5245967',
 '5266013',
 '5038641',
 '1006203',
 '1040162',
 '5217881',
 '5098169',
 '1039395',
 '1061185',
 '5210477',
 '5240472',
 '1000890',
 '5044314',
 '1055376',
 '1035219',
 '1049513',
 '5099664',
 '5260037',
 '5084553',
 '5348482',
 '1047855',
 '1060602',
 '5353790',
 '1046797',
 '5042305',
 '1005764',
 '5145642',
 '1034227',
 '5310366',
 '5018107',
 '5264649',
 '1014718',
 '5308603',
 '1030749',
 '5107124',
 '1043721',
 '1047433',
 '5078100',
 '1004531',
 '5087303',
 '5052638',
 '5030948',
 '1037345',
 '1043733',
 '5189111',
 '1017007',
 '5355165',
 '1030944',
 '5011564',
 '5015193',
 '5004718',
 '1032844',
 '1048338',
 '5078423',
 '5011219',
 '5254759',
 '5296194',
 '1047448',
 '5014199',
 '5008687',
 '5001841',
 '1064258',
 '5013753',
 '1048917',
 '5136309',
 '5030396',
 '5009458',
 '5096842',
 '5079081',
 '1059072',
 '5007994',
 '1004992',
 '1046979',
 '1041956',
 '1048493',
 '1037155',
 '5104910',
 '5018316',
 '5030095',
 '5023440',
 '1034407',
 '5041229',
 '1036399',
 '1047137',
 '5019142',
 '5032793',
 '5190980',
 '5006561',
 '5034647',
 '1002861',
 '1026470',
 '5222145',
 '1041113',
 '1018383',
 '5070610',
 '5262299',
 '5109117',
 '5020068',
 '1044837',
 '5190337',
 '5076017',
 '1017678',
 '1043406',
 '5040158',
 '5268468',
 '1042486',
 '5019773',
 '5035886',
 '5222696',
 '5036228',
 '5013260',
 '5138141',
 '5295997',
 '5014982',
 '1020029',
 '5220775',
 '1058862',
 '1046162',
 '5031941',
 '1020931',
 '1034112',
 '1043659',
 '5350578',
 '5251439',
 '1041024',
 '5051137',
 '1045863',
 '1041399',
 '1040728',
 '5271895',
 '1044428',
 '5016548',
 '5081098',
 '5026430',
 '5255484',
 '5023173',
 '1041872',
 '1038033',
 '5136539',
 '1048472',
 '1038727',
 '1004298',
 '1044156',
 '1012176',
 '1042439',
 '5096348',
 '1038735',
 '5031233',
 '5152591',
 '5039844',
 '1041717',
 '5326463',
 '1040245',
 '5029756',
 '5225880',
 '1035475',
 '5001977',
 '1044260',
 '1023320',
 '1040879',
 '5028048',
 '5335319',
 '5037514',
 '5012016',
 '5045155',
 '5128886',
 '1042253',
 '5041541',
 '1015857',
 '5030777',
 '5175243',
 '5045319',
 '5071082',
 '5347502',
 '1007460',
 '1037958',
 '1003342',
 '5028368',
 '5063966',
 '5038492',
 '5310346',
 '5273946',
 '1046563',
 '5010332',
 '1031693',
 '5349715',
 '5021151',
 '5099573',
 '1008337',
 '1039091',
 '5253780',
 '5354324',
 '1041489',
 '1061281',
 '5243892',
 '1041403',
 '5083997',
 '5299223',
 '5036451',
 '5008719',
 '5270345',
 '1063054',
 '5106470',
 '1044242',
 '1038983',
 '1040932',
 '5109731',
 '1039542',
 '5193460',
 '1047333',
 '1044175',
 '5008176',
 '1042150',
 '5005970',
 '5006694',
 '1060871',
 '1130034',
 '5094420',
 '1053542',
 '5190435',
 '5023197',
 '5191167',
 '5306479',
 '1061676',
 '1030248',
 '5191544',
 '1148791',
 '5029145',
 '5190867',
 '5026705',
 '5036075',
 '5188889',
 '5019447',
 '5191045',
 '1037685',
 '1065454',
 '5029074',
 '1046008',
 '5066118',
 '1057760',
 '5078962',
 '1018801',
 '5016168',
 '5349798',
 '1041733',
 '5007698',
 '5240186',
 '5016099',
 '5283155',
 '5190026',
 '5107730',
 '1057916',
 '5023750',
 '5010954',
 '5017193',
 '1049996',
 '1033739',
 '5091660',
 '1037550',
 '5323306',
 '5126479',
 '5039808',
 '5216496',
 '5032561',
 '5305775',
 '5189002',
 '1039445',
 '1046538',
 '1036716',
 '5285163',
 '1059810',
 '1059752',
 '1042180',
 '5005851',
 '5074626',
 '5087880',
 '1044594',
 '5187214',
 '5009203',
 '5307587',
 '1020806',
 '5022530',
 '5127352',
 '5008290',
 '1060678',
 '5002251',
 '1033163',
 '5016127',
 '5003984',
 '5018726',
 '1043818',
 '5239438',
 '5121052',
 '5087531',
 '1044825',
 '5010102',
 '5011061',
 '1060434',
 '1033219',
 '1042494',
 '1036199',
 '5032593',
 '1047337',
 '5264731',
 '5041646',
 '5023936',
 '5354788',
 '1049699',
 '5025018',
 '5049063',
 '1004189',
 '1033586',
 '1048771',
 '1000620',
 '5028612',
 '1043854',
 '1019882',
 '1040319',
 '1037801',
 '1042564',
 '1041313',
 '5064979',
 '1052884',
 '5222586',
 '5090510',
 '5273942',
 '5015564',
 '5008653',
 '5348922',
 '1033802',
 '5239071',
 '5010169',
 '5355923',
 '5105458',
 '5001222',
 '5032690',
 '1041908',
 '5331428',
 '5352701',
 '5055210',
 '5056584',
 '5190891',
 '1034598',
 '1039576',
 '5341688',
 '5299635',
 '5042422',
 '5030346',
 '5045381',
 '1029058',
 '5027570',
 '5094113',
 '1016390',
 '5041428',
 '1148807',
 '5326597',
 '1046654',
 '1027312',
 '1003761',
 '5010005',
 '5175242',
 '5090369',
 '5083315',
 '5002182',
 '1148815',
 '1058023',
 '5043999',
 '5035622',
 '5026725',
 '5027386',
 '1059152',
 '5129446',
 '5034182',
 '1005762',
 '1049883',
 '1033296',
 '5030282',
 '5098402',
 '1042933',
 '5311378',
 '1051361',
 '1032838',
 '5113093',
 '5017240',
 '1038908',
 '1057696',
 '5228154',
 '5014006',
 '5090890',
 '1132533',
 '1041938',
 '5080709',
 '5001947',
 '5030597',
 '5027661',
 '5080783',
 '1057685',
 '5040388',
 '5190839',
 '5026679',
 '1039090',
 '1037343',
 '1009255',
 '5295993',
 '5098149',
 '1048888',
 '5098939',
 '1049808',
 '1037804',
 '5357665',
 '5004452',
 '5041072',
 '5020534',
 '5043766',
 '5038043',
 '5084608',
 '5102930',
 '5022689',
 '1047217',
 '5079387',
 '1009629',
 '5141508',
 '1039360',
 '5090732',
 '5021197',
 '5107876',
 '5189851',
 '5260478',
 '5106907',
 '1030702',
 '1034850',
 '1000700',
 '1005418',
 '1037645',
 '1055651',
 '5099457',
 '1051139',
 '5027438',
 '5189883',
 '5189110',
 '1043278',
 '1035061',
 '5064764',
 '5033627',
 '5216750',
 '5189891',
 '5036185',
 '5042402',
 '5147260',
 '5269374',
 '1005063',
 '1037888',
 '1043027',
 '1042144',
 '5025889',
 '5052383',
 '5007437',
 '1003380',
 '5011055',
 '5288223',
 '5043284',
 '5216497',
 '5259140',
 '1039773',
 '1057904',
 '5263190',
 '5047184',
 '5218756',
 '5111065',
 '1002722',
 '5219205',
 '5243701',
 '5020134',
 '5357619',
 '1033934',
 '5025183',
 '5091166',
 '5037435',
 '5042132',
 '1010052',
 '1020583',
 '5189421',
 '1046802',
 '1007144',
 '5028736',
 '5350602',
 '5087530',
 '1067142',
 '5240849',
 '1000179',
 '5250632',
 '1021769',
 '1034659',
 '5040223',
 '1040071',
 '1005156',
 '5039212',
 '5007938',
 '5246242',
 '5191541',
 '1032013',
 '1061672',
 '1037380',
 '5355366',
 '5044829',
 '5149164',
 '5250516',
 '5085614',
 '5264101',
 '1038215',
 '5228239',
 '1047325',
 '5269470',
 '1004235',
 '5002949',
 '5102451',
 '1019521',
 '5002139',
 '5100060',
 '5249026',
 '5246374',
 '5018884',
 '5223882',
 '1058863',
 '5001950',
 '1034970',
 '5040499',
 '5042724',
 '1039253',
 '1043407',
 '5051449',
 '5295314',
 '1044650',
 '5036472',
 '5040788',
 '5038642',
 '1063065',
 '5222594',
 '1012662',
 '5258887',
 '1056503',
 '5214685',
 '1035372',
 '5217809',
 '1011323',
 '5216450',
 '5039856',
 '1034202',
 '1032235',
 '5022908',
 '5041243',
 '5243952',
 '5012919',
 '1027149',
 '1003528',
 '1032972',
 '1044655',
 '1057629',
 '5189941',
 '1000232',
 '5035623',
 '5274694',
 '5111145',
 '1050112',
 '1010675',
 '5029740',
 '5003961',
 '5087864',
 '1043865',
 '5127868',
 '1042177',
 '5241945',
 '1057587',
 '1012091',
 '5115878',
 '1044394',
 '5011791',
 '1062883',
 '1040177',
 '1042560',
 '5017554',
 '5016876',
 '1025420',
 '1022927',
 '5191375',
 '5043738',
 '1043411',
 '5243963',
 '5022411',
 '1019699',
 '5336877',
 '5078977',
 '5104286',
 '5025916',
 '5087727',
 '1043726',
 '5042027',
 '1054449',
 '1059544',
 '5005225',
 '1032839',
 '5014986',
 '5253781',
 '5037961',
 '5004440',
 '1051597',
 '1029967',
 '1063740',
 '5096288',
 '5011028',
 '1055345',
 '1007807',
 '5036739',
 '1020357',
 '5024217',
 '1044051',
 '1046297',
 '5020105',
 '1010686',
 '5026839',
 '5240495',
 '5068477',
 '1011893',
 '1041117',
 '5192710',
 '1002994',
 '1042238',
 '5133734',
 '1047943',
 '5020221',
 '5037844',
 '5077362',
 '5088989',
 '1044508',
 '1031916',
 '5099197',
 '5014215',
 '5340176',
 '5029383',
 '1034305',
 '1058977',
 '1040593',
 '1039193',
 '5011284',
 '5267593',
 '5222174',
 '1048786',
 '5286702',
 '5109134',
 '5093553',
 '5000738',
 '5017456',
 '5188792',
 '1039355',
 '1005673',
 '1049001',
 '1006435',
 '5109945',
 '5083768',
 '1021631',
 '5039525',
 '1059807',
 '5041629',
 '5285904',
 '5252778',
 '5044198',
 '1035555',
 '5018179',
 '1046807',
 '5190840',
 '5191562',
 '5220790',
 '5271336',
 '5135557',
 '1032673',
 '1044942',
 '5028382',
 '1045460',
 '5128791',
 '1002662',
 '5050985',
 '5077200',
 '5052702',
 '1004493',
 '5174814',
 '1027827',
 '1000793',
 '1051334',
 '5106877',
 '5028566',
 '1010892',
 '5046750',
 '5029417',
 '5003246',
 '1044838',
 '1009213',
 '5035485',
 '1044588',
 '5281316',
 '5100435',
 '5001935',
 '1061856',
 '1046601',
 '5001651',
 '5053418',
 '5070826',
 '5012284',
 '1006557',
 '5102874',
 '5331217',
 '5213329',
 '5303598',
 '1056868',
 '1037864',
 '5124363',
 '1033306',
 '1030931',
 '5139587',
 '1042598',
 '5254591',
 '5083619',
 '1043040',
 '5091706',
 '1011827',
 '1041830',
 '5005667',
 '5281305',
 '1042214',
 '5096062',
 '1043793',
 '5006517',
 '5030458',
 '1000772',
 '1030692',
 '5040912',
 '1038653',
 '1043906',
 '5353178',
 '5021424',
 '5009142',
 '5069926',
 '5143315',
 '1030076',
 '5246079',
 '5212207',
 '5351335',
 '1039398',
 '5258182',
 '5085328',
 '5108983',
 '5042868',
 '5036515',
 '5090836',
 '1012334',
 '1038486',
 '1035952',
 '1047152',
 '5080724',
 '1048079',
 '5117846',
 '5027867',
 '5222613',
 '5222699',
 '5035061',
 '1044711',
 '5012418',
 '1007601',
 '1043397',
 '5219157',
 '5219145',
 '1028349',
 '5039673',
 '5092344',
 '1039991',
 '5147726',
 '1025256',
 '5019458',
 '5135949',
 '5269517',
 '5008865',
 '1017676',
 '1031049',
 '1037896',
 '1028117',
 '5105585',
 '1032628',
 '5024794',
 '5013720',
 '5243690',
 '1041392',
 '1042406',
 '5022565',
 '5013844',
 '5120662',
 '5044915',
 '5039676',
 '5117317',
 '1058998',
 '5238743',
 '1028893',
 '5250675',
 '5003460',
 '5218736',
 '5076167',
 '5009989',
 '5085083',
 '5120397',
 '1002452',
 '1055589',
 '5353258',
 '5113031',
 '5013980',
 '5350671',
 '5024650',
 '5025279',
 '5042339',
 '5005052',
 '5001340',
 '1049138',
 '5099861',
 '1041796',
 '1023175',
 '5215684',
 '5190767',
 '1059720',
 '1032182',
 '1049744',
 '1011915',
 '5015855',
 '5322537',
 '1012331',
 '5030974',
 '1045643',
 '5042473',
 '5001922',
 '1041056',
 '5065786',
 '5041627',
 '1045684',
 '5353598',
 '5095021',
 '1033311',
 '1031034',
 '1044891',
 '5039190',
 '1064240',
 '1041291',
 '5271167',
 '5095939',
 '5261617',
 '5317166',
 '5338907',
 '1061159',
 '5055161',
 '1042203',
 '1038197',
 '1038804',
 '1056661',
 '5012594',
 '5081767',
 '5345999',
 '5016346',
 '5241039',
 '1036925',
 '5094177',
 '1062250',
 '1034641',
 '1031918',
 '1043813',
 '5218769',
 '5087528',
 '1042893',
 '5018932',
 '5190541',
 '1039598',
 '1030795',
 '5024594',
 '1008138',
 '5036568',
 '5092264',
 '5260595',
 '5277671',
 '1033919',
 '5090647',
 '5014290',
 '1038295',
 '1033706',
 '1002245',
 '1028025',
 '5024753',
 '5171956',
 '1064266',
 '1043070',
 '1005720',
 '5006486',
 '1031251',
 '1061786',
 '1065577',
 '5149161',
 '5014952',
 '1030789',
 '1034032',
 '5020885',
 '1036032',
 '1033672',
 '5280424',
 '1024776',
 '5273012',
 '5252779',
 '1049714',
 '5354226',
 '1033571',
 '5257820',
 '1061497',
 '5006666',
 '5268846',
 '1046618',
 '5015691',
 '1007905',
 '1047358',
 '5043836',
 '1041598',
 '1046815',
 '1002021',
 '5028422',
 '5295227',
 '5085829',
 '5038340',
 '1043074',
 '5245664',
 '5077137',
 '5020074',
 '5030716',
 '1065659',
 '5015598',
 '1042689',
 '5087773',
 '5052710',
 '5110293',
 '5012807',
 '1046510',
 '5001092',
 '1032085',
 '1031703',
 '1058756',
 '1038373',
 '5012353',
 '5347028',
 '5080769',
 '1002933',
 '5074539',
 '5353632',
 '5347661',
 '1069966',
 '1038193',
 '5191031',
 '5107150',
 '5064789',
 '5017527',
 '1063732',
 '5093863',
 '1064674',
 '5301214',
 '1061844',
 '5024692',
 '5282385',
 '1047352',
 '5282397',
 '5012285',
 '1033315',
 '5221242',
 '1058065',
 '1032807',
 '5264670',
 '5308219',
 '5000973',
 '1041914',
 '1000691',
 '1032186',
 '1053458',
 '5230273',
 '5003979',
 '1048137',
 '5269112',
 '5134886',
 '5129612',
 '1012549',
 '1012908',
 '5213376',
 '1042864',
 '1027924',
 '5355310',
 '5022546',
 '1048759',
 '5078949',
 '5010251',
 '5184855',
 '1047922',
 '1028116',
 '1031502',
 '5056602',
 '1064695',
 '1059678',
 '5349170',
 '5022143',
 '1031627',
 '5301939',
 '5075559',
 '5029605',
 '1060586',
 '5067229',
 '5289325',
 '5190297',
 '5031360',
 '5002955',
 '1023859',
 '5302147',
 '1045868',
 '5091769',
 '5221190',
 '1037236',
 '5105751',
 '1048699',
 '5022486',
 '1041924',
 '1048230',
 '1027086',
 '1040024',
 '5263707',
 '5336879',
 '5009244',
 '1042399',
 '5020319',
 '5072482',
 '5191506',
 '1030740',
 '5013404',
 '5031746',
 '5131687',
 '1006538',
 '5213354',
 '1023481',
 '5036698',
 '5268463',
 '5084300',
 '5190979',
 '1062186',
 '1042327',
 '5053685',
 '1000694',
 '5191103',
 '1033973',
 '1014724',
 '5216449',
 '1004292',
 '1033234',
 '5090296',
 '1036835',
 '5001692',
 '5004130',
 '5039574',
 '1049508',
 '5102137',
 '1041438',
 '5006468',
 '1044732',
 '5029133',
 '5328962',
 '5025960',
 '5038809',
 '1031856',
 '1040621',
 '1066555',
 '1043585',
 '1042944',
 '5078664',
 '5145748',
 '5171963',
 '5352128',
 '1018336',
 '1043283',
 '1042632',
 '1038445',
 '1032934',
 '5107146',
 '5079302',
 '5024280',
 '1038294',
 '5022346',
 '1056858',
 '5270315',
 '5078156',
 '5090859',
 '5190170',
 '5053664',
 '1032541',
 '5260594',
 '5120747',
 '1037722',
 '5011234',
 '5257882',
 '5118008',
 '1004485',
 '5007848',
 '1005034',
 '5201952',
 '5265101',
 '5024370',
 '5001672',
 '5317153',
 '1039624',
 '1048158',
 '1045464',
 '5032014',
 '1031993',
 '1046630',
 '5017470',
 '5040521',
 '5015295',
 '1039070',
 '1044353',
 '5096036',
 '1020837',
 '5023128',
 '1050658',
 '5190412',
 '5118727',
 '1045894',
 '1025459',
 '5192841',
 '1022054',
 '5099831',
 '1012835',
 '1034799',
 '1028914',
 '1039346',
 '5305770',
 '5349079',
 '5253609',
 '5123441',
 '5029081',
 '5273013',
 '5259642',
 '1036482',
 '5028650',
 '5019399',
 '1004387',
 '1053179',
 '5258664',
 '1041457',
 '1034408',
 '1023685',
 '5042538',
 '1049308',
 '5042451',
 '1033004',
 '5190557',
 '5003254',
 '5101923',
 '5014593',
 '5030178',
 '5012814',
 '5085185',
 '1063325',
 '1044133',
 '1129090',
 '5246098',
 '1058296',
 '5214023',
 '5031565',
 '5247260',
 '1041831',
 '5159580',
 '5012756',
 '5282396',
 '5030269',
 '5112766',
 '1048559',
 '1046358',
 '1041294',
 '5198118',
 '5014351',
 '1003316',
 '1058771',
 '5019179',
 '5254757',
 '5191030',
 '1030276',
 '1010956',
 '5347660',
 '5031063',
 '5304646',
 '5317219',
 '5153362',
 '5014573',
 '1034129',
 '1065517',
 '5014849',
 '1039313',
 '5301258',
 '1038641',
 '5190680',
 '1055759',
 '5085793',
 '5021006',
 '1065202',
 '1038729',
 '5093955',
 '1048946',
 '5191107',
 '5074485',
 '5080315',
 '1047029',
 '5097531',
 '5338283',
 '5340778',
 '5016546',
 '5246124',
 '1004762',
 '5000622',
 '5104637',
 '5189067',
 '5020274',
 '5015015',
 '1064899',
 '5085038',
 '5349163',
 '5348000',
 '1065531',
 '1046997',
 '1044004',
 '1005600',
 '5083783',
 '1057965',
 '1023029',
 '5028693',
 '5020924',
 '5338197',
 '5023723',
 '5270222',
 '5025993',
 '1041936',
 '5036525',
 '1046980',
 '5083080',
 '5005691',
 '1040846',
 '5214955',
 '5031463',
 '5012273',
 '1006802',
 '5042387',
 '1045869',
 '5094958',
 '1033200',
 '1032740',
 '5090681',
 '5007052',
 '1044721',
 '1029638',
 '1041550',
 '1004836',
 '1049745',
 '5190060',
 '5348158',
 '1041667',
 '1062618',
 '1040716',
 '5350252',
 '5098543',
 '1046310',
 '1039727',
 '5013324',
 '1022984',
 '1023174',
 '5026566',
 '5040916',
 '5012786',
 '5038034',
 '1038657',
 '5006207',
 '1038933',
 '1032889',
 '5042557',
 '5003619',
 '5008731',
 '5043951',
 '1047811',
 '5092339',
 '1001731',
 '5078540',
 '5188982',
 '5039696',
 '1045356',
 '5097851',
 '1004080',
 '5006700',
 '5001386',
 '1126632',
 '1005337',
 '1054709',
 '5090242',
 '5080449',
 '5243240',
 '5035557',
 '1042135',
 '1057997',
 '5222707',
 '5117059',
 '5005914',
 '1044973',
 '1045451',
 '5240986',
 '5127048',
 '5004015',
 '1034989',
 '5091017',
 '1032567',
 '1047888',
 '5266827',
 '5090916',
 '5260218',
 '5217428',
 '5017505',
 '5191336',
 '1048929',
 '5243275',
 '1042225',
 '5201953',
 '5083595',
 '5242488',
 '1037659',
 '1033992',
 '1041440',
 '1004926',
 '5264686',
 '5266800',
 '1061249',
 '1064038',
 '1033431',
 '1049646',
 '5045130',
 '1038823',
 '1002543',
 '1058281',
 '5040455',
 '5025299',
 '1042459',
 '1023187')
)

,res1 as (
select now() ,'${StartDay}' as firstday , '${ReportType}' as reporttype
    ,ms.ShopStatus ,t0.shopcode ,t0.SellerSKU
    ,t0.sku ,t0.spu
    ,新老品  ,主题 ,t0.优先级元素  ,高潜 ,一级类目 ,终审年月
    ,ifnull(lst_pub_tag ,'其他链接')  链接刊登划分
    ,case when '${ReportType}' = '周报' then week_num_in_year when '${ReportType}' = '月报' then month end as 自然周月
     ,firstday as 当期第一天 ,ms.CompanyCode ,ms.AccountCode ,区域 ,销售小组 ,销售人员
    ,ifnull(salecount,0) `销量`
    ,ifnull(orders_cnt,0) `订单量`
    ,ifnull(sales,0) `销售额`
    ,ifnull(profit,0) 利润额_未扣ad
    ,round(ifnull(profit,0) - ifnull(ad_Spend,0),2) `利润额_扣ad`
    ,ifnull(ori_gross,0) `销售额_扣运费未扣退款`
    ,ifnull(ori_profit,0) `利润额_扣运费未扣退款`
    ,round (  ori_profit /  ori_gross  ,4 ) 挂单利润率
    ,ifnull(sales_refund,0) `退款额`
    ,ifnull(运费收入,0) `运费收入`
    ,ifnull(交易成本,0) `交易成本`
    ,ifnull(采购成本,0) `采购成本`
    ,ifnull(物流成本,0) `物流成本`
    ,ad_sku_Exposure `广告曝光量`
    ,ifnull(ad_Spend,0) `广告花费`
    ,ad_TotalSale7Day `广告销售额`
    ,ad_sku_TotalSale7DayUnit `广告销量`
    ,ad_sku_Clicks `广告点击量`
    ,是否结算项记录
    ,ol.SellerSKU as online_sellersku
from t0
left join od_stat on t0.ShopCode = od_stat.ShopCode and t0.SellerSku = od_stat.SellerSku and t0.sku =od_stat.sku
left join t_ad_stat  on t0.ShopCode = t_ad_stat.ShopCode and t0.SellerSku = t_ad_stat.SellerSku
left join view_kbh_lst_pub_tag vl on t0.SellerSku=vl.SellerSKU and t0.shopcode = vl.shopcode
left join (select * , case when NodePathName regexp  '成都' then '成都' else '泉州' end as 区域 , NodePathName as 销售小组 ,SellUserName 销售人员
      from mysql_store where Department = '快百货') ms on t0.shopcode = ms.code
join erp_product_products epp on epp.sku = t0.sku and epp.ProjectTeam='快百货' and epp.IsMatrix=0
left join online_lst ol on t0.ShopCode = ol.ShopCode and t0.SellerSku = ol.SellerSku
order by t0.shopcode ,t0.SellerSKU ,t0.sku ,自然周月 ,当期第一天
)


,res2 as ( -- 链接聚合
select now() ,'${StartDay}' as firstday , '${ReportType}' as reporttype
    ,ShopStatus ,res1.shopcode ,链接刊登划分 ,终审年月 ,新老品 ,优先级元素 ,自然周月 ,当期第一天  ,CompanyCode,AccountCode,区域,销售小组,销售人员
    ,round(sum(销量),0) 销量
    ,round(sum(销售额),2) 销售额
    ,round(sum(利润额_扣ad),2) 利润额_扣ad
    ,round(sum(利润额_未扣ad),2) 利润额_未扣ad
    ,round(sum(销售额_扣运费未扣退款),2) 销售额_扣运费未扣退款
    ,round(sum(利润额_扣运费未扣退款),2) 利润额_扣运费未扣退款
    ,round(sum(退款额),2) 退款额
    ,round(sum(广告曝光量)) 广告曝光量
    ,round(sum(广告花费),2)  广告花费
    ,round(sum(广告销售额),2) 广告销售额
    ,round(sum(广告销量),2) 广告销量
    ,round(sum(广告点击量),2) 广告点击量
    ,round(sum(运费收入),2) 运费收入
    ,round(sum(交易成本),2) 交易成本
    ,round(sum(采购成本),2) 采购成本
    ,round(sum(物流成本),2) 物流成本
    ,主题 ,高潜 ,一级类目 ,是否结算项记录
    ,count( distinct online_sellersku) 在线渠道SKU数
from res1
group by ShopStatus ,res1.shopcode ,新老品  ,主题 ,优先级元素 ,高潜,一级类目 ,终审年月 ,链接刊登划分 ,自然周月 ,当期第一天,CompanyCode,AccountCode,区域,销售小组,销售人员 ,是否结算项记录
)


-- 明细表
-- select * from res1 ;
-- 聚合表
select * from res2
-- select count(1) from res2;



-- 广告对比
-- select sum(ad_Spend) from t_ad_stat;
-- select sum(退款额) from res1;

-- 销售对比
-- select sum(利润额_扣ad)/sum(销售额) from res3;
-- select sum(当前未停产SPU数) from res3;
-- select sum(TotalGross_weekly) from t_orde_week_stat;

